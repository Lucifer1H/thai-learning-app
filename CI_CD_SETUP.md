# CI/CD é…ç½®æŒ‡å—

## ğŸ”§ å½“å‰çŠ¶æ€

âœ… **å·²ä¿®å¤çš„é—®é¢˜ï¼š**
- æ›´æ–°äº†ä»“åº“URLé…ç½®
- æ·»åŠ äº†Next.jsé…ç½®æ–‡ä»¶
- ç®€åŒ–äº†GitHub Actionså·¥ä½œæµ
- æ·»åŠ äº†å®¹é”™å¤„ç†

âš ï¸ **éœ€è¦è¿›ä¸€æ­¥é…ç½®çš„é¡¹ç›®ï¼š**
- Supabaseç¯å¢ƒå˜é‡
- éƒ¨ç½²secretsé…ç½®
- æµ‹è¯•æ¡†æ¶å®Œæ•´è®¾ç½®

## ğŸš€ å¯ç”¨å®Œæ•´CI/CDçš„æ­¥éª¤

### 1. é…ç½®GitHub Secrets

åœ¨GitHubä»“åº“ä¸­æ·»åŠ ä»¥ä¸‹Secretsï¼š
1. è¿›å…¥ `Settings` â†’ `Secrets and variables` â†’ `Actions`
2. æ·»åŠ ä»¥ä¸‹secretsï¼š

```
NEXT_PUBLIC_SUPABASE_URL=your_supabase_project_url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key
VERCEL_TOKEN=your_vercel_token (å¯é€‰ï¼Œç”¨äºè‡ªåŠ¨éƒ¨ç½²)
VERCEL_ORG_ID=your_vercel_org_id (å¯é€‰)
VERCEL_PROJECT_ID=your_vercel_project_id (å¯é€‰)
```

### 2. å¯ç”¨éƒ¨ç½²ä½œä¸š

é…ç½®å¥½secretsåï¼Œç¼–è¾‘ `.github/workflows/ci.yml`ï¼š
- å–æ¶ˆæ³¨é‡Š `deploy-preview` å’Œ `deploy-production` ä½œä¸š
- ç§»é™¤æ³¨é‡Šæ ‡è®° `#`

### 3. æœ¬åœ°å¼€å‘è®¾ç½®

```bash
# å®‰è£…ä¾èµ–
npm install

# åˆ›å»ºç¯å¢ƒå˜é‡æ–‡ä»¶
cp .env.local.example .env.local

# ç¼–è¾‘ .env.local æ·»åŠ æ‚¨çš„é…ç½®
# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev
```

### 4. æµ‹è¯•é…ç½®

å½“å‰æµ‹è¯•é…ç½®å·²å°±ç»ªï¼Œä½†éœ€è¦å®‰è£…æµ‹è¯•ä¾èµ–ï¼š

```bash
# å®‰è£…æµ‹è¯•ç›¸å…³ä¾èµ–
npm install --save-dev @testing-library/react @testing-library/jest-dom jest jest-environment-jsdom

# è¿è¡Œæµ‹è¯•
npm run test
```

## ğŸ“‹ CI/CD å·¥ä½œæµè¯´æ˜

### å½“å‰å¯ç”¨çš„ä½œä¸šï¼š

1. **lint-and-test** - ä»£ç æ£€æŸ¥å’Œæµ‹è¯•
   - ESLintä»£ç è§„èŒƒæ£€æŸ¥
   - TypeScriptç±»å‹æ£€æŸ¥
   - Jestå•å…ƒæµ‹è¯•ï¼ˆå¦‚æœé…ç½®ï¼‰
   - Next.jsæ„å»ºæµ‹è¯•

2. **security-scan** - å®‰å…¨æ‰«æ
   - npm auditå®‰å…¨æ¼æ´æ£€æŸ¥
   - ä¾èµ–åŒ…å®‰å…¨æ€§éªŒè¯

### æš‚æ—¶ç¦ç”¨çš„ä½œä¸šï¼š

3. **deploy-preview** - PRé¢„è§ˆéƒ¨ç½²
4. **deploy-production** - ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

## ğŸ” æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜ï¼š

1. **æ„å»ºå¤±è´¥ - ç¼ºå°‘ç¯å¢ƒå˜é‡**
   - è§£å†³æ–¹æ¡ˆï¼šé…ç½®GitHub Secretsæˆ–æœ¬åœ°.env.localæ–‡ä»¶

2. **æµ‹è¯•å¤±è´¥ - Jestæœªé…ç½®**
   - è§£å†³æ–¹æ¡ˆï¼šè¿è¡Œ `npm install` å®‰è£…æµ‹è¯•ä¾èµ–

3. **ESLinté”™è¯¯**
   - è§£å†³æ–¹æ¡ˆï¼šè¿è¡Œ `npm run lint:fix` è‡ªåŠ¨ä¿®å¤

### æ£€æŸ¥CIçŠ¶æ€ï¼š

```bash
# æŸ¥çœ‹æœ€æ–°æäº¤çŠ¶æ€
git log --oneline -5

# æ£€æŸ¥è¿œç¨‹çŠ¶æ€
git status
```

## ğŸ“ˆ ä¸‹ä¸€æ­¥å»ºè®®

1. **ç«‹å³å¯åšï¼š**
   - è®¾ç½®Supabaseé¡¹ç›®
   - é…ç½®æœ¬åœ°ç¯å¢ƒå˜é‡
   - è¿è¡Œæœ¬åœ°å¼€å‘æœåŠ¡å™¨

2. **é…ç½®å®Œæˆåï¼š**
   - å¯ç”¨è‡ªåŠ¨éƒ¨ç½²
   - è®¾ç½®åˆ†æ”¯ä¿æŠ¤è§„åˆ™
   - é…ç½®ä»£ç å®¡æŸ¥è¦æ±‚

3. **é•¿æœŸä¼˜åŒ–ï¼š**
   - æ·»åŠ æ›´å¤šæµ‹è¯•ç”¨ä¾‹
   - é…ç½®æ€§èƒ½ç›‘æ§
   - è®¾ç½®é”™è¯¯è¿½è¸ª

## ğŸ¯ å¿«é€ŸéªŒè¯

è¿è¡Œä»¥ä¸‹å‘½ä»¤éªŒè¯é…ç½®ï¼š

```bash
# æ£€æŸ¥ä¾èµ–
npm list

# æ£€æŸ¥é…ç½®æ–‡ä»¶
ls -la .env* next.config.js tsconfig.json

# æµ‹è¯•æ„å»º
npm run build

# è¿è¡Œä»£ç æ£€æŸ¥
npm run lint
```

---

**é…ç½®å®Œæˆåï¼Œæ‚¨çš„CI/CDæµæ°´çº¿å°†è‡ªåŠ¨å¤„ç†ä»£ç æ£€æŸ¥ã€æµ‹è¯•å’Œéƒ¨ç½²ï¼** ğŸš€
